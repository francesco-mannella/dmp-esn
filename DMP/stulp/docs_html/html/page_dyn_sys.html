<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>DMP_BBO library: Dynamical Systems Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DMP_BBO library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Dynamical Systems Module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_dyn_sys_intro"></a>
Introduction</h1>
<p>Let a <em>state</em> be a vector of real numbers. A dynamical system consists of such a state and a rule that describes how this state will change over time; it describes what future state follows from the current state. A typical example is radioactive decay, where the state <img class="formulaInl" alt="$x$" src="form_40.png"/> is the number of atoms, and the rate of decay is <img class="formulaInl" alt="$\frac{dx}{dt}$" src="form_41.png"/> proportional to <img class="formulaInl" alt="$x$" src="form_40.png"/>: <img class="formulaInl" alt="$ \frac{dx}{dt} = -\alpha x$" src="form_42.png"/>. Here, <img class="formulaInl" alt="$\alpha$" src="form_9.png"/> is the `decay constant' and <img class="formulaInl" alt="$\dot{x}$" src="form_43.png"/> is a shorthand for <img class="formulaInl" alt="$\frac{dx}{dt}$" src="form_41.png"/>. Such an evolution rule describes an implicit relation between the current state <img class="formulaInl" alt="$ x(t) $" src="form_44.png"/> and the state a short time in the future <img class="formulaInl" alt="$x(t+dt)$" src="form_45.png"/>.</p>
<p>If we know the initial state of a dynamical system, e.g. <img class="formulaInl" alt="$x_0\equiv x(0)=4$" src="form_46.png"/>, we may compute the evolution of the state over time through <em>numerical</em> <em>integration</em>. This means we take the initial state <img class="formulaInl" alt="$ x_0$" src="form_47.png"/>, and iteratively compute subsequent states <img class="formulaInl" alt="$x(t+dt)$" src="form_45.png"/> by computing the rate of change <img class="formulaInl" alt="$\dot{x}$" src="form_43.png"/>, and integrating this over the small time interval <img class="formulaInl" alt="$dt$" src="form_48.png"/>. A pseudo-code example is shown below for <img class="formulaInl" alt="$x_0\equiv x(0)=4$" src="form_46.png"/>, <img class="formulaInl" alt="$dt=0.01s$" src="form_49.png"/> and <img class="formulaInl" alt="$\alpha=6$" src="form_50.png"/>.</p>
<div class="fragment"><div class="line">alpha=6; <span class="comment">// Decay constant</span></div>
<div class="line">dt=0.01; <span class="comment">// Duration of one integration step</span></div>
<div class="line">x=4.0;   <span class="comment">// Initial state</span></div>
<div class="line">t=0.0;   <span class="comment">// Initial time</span></div>
<div class="line"><span class="keywordflow">while</span> (t&lt;1.5) {</div>
<div class="line">  dx = -alpha*x;  <span class="comment">// Dynamical system rule</span></div>
<div class="line">  x = x + dx*dt;  <span class="comment">// Project x into the future for a small time step dt (Euler integration)</span></div>
<div class="line">  t = t + dt;     <span class="comment">// The future is now!</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>This procedure is called ``integrating the system'', and leads the trajectory plotted below (shown for both <img class="formulaInl" alt="$\alpha=6$" src="form_50.png"/> and <img class="formulaInl" alt="$\alpha=3$" src="form_51.png"/>.</p>
<div class="image">
<img src="exponential_decay-svg.png" alt="exponential_decay-svg.png"/>
<div class="caption">
Evolution of the exponential dynamical system.</div></div>
<p>The evolution of many dynamical systems can also be determined analytically, by explicitly solving the differential equation. For instance, <img class="formulaInl" alt="$N(t) = x_0e^{-\alpha t}$" src="form_52.png"/> is the solution to <img class="formulaInl" alt="$\dot{x} = -\alpha x$" src="form_53.png"/>. Why? Let's plug <img class="formulaInl" alt="$x(t) = x_0e^{-\alpha t}$" src="form_54.png"/> into <img class="formulaInl" alt="$\frac{dx}{dt} = -\alpha x$" src="form_55.png"/>, which leads to <img class="formulaInl" alt="$\frac{d}{dt}(x_0e^{-\alpha t}) = -\alpha (x_0e^{-\alpha t})$" src="form_56.png"/>. Then derive the left side of the equations, which yields <img class="formulaInl" alt="$-\alpha(x_0e^{-\alpha t}) = -\alpha (x_0e^{-\alpha t})$" src="form_57.png"/>. QED. Note that the solution works for arbitrary <img class="formulaInl" alt="$x_0$" src="form_58.png"/>. It should, because the solution should not depend on the initial state.</p>
<h2><a class="anchor" id="dynsys_implementation1"></a>
Implementation</h2>
<p><em> In the object-oriented implementation of this module, all dynamical systems inherit from the abstract DynamicalSystem class. The analytical solution of a dynamical system is computed with DynamicalSystem::analyticalSolution, which takes the times <code>ts</code> at which the solution should be computed, and returns the evolution of the system as <code>xs</code> and <code>xds</code>.</em></p>
<p><em>A system's differential equation is implement in the function DynamicalSystem::differentialEquation, which takes the current state <code>x</code>, and computes the rates of change <code>xd</code>. The functions DynamicalSystem::integrateStart() and DynamicalSystem::integrateStep() are then used to numerically integrate the system as follows (using the example plotted above):</em></p>
<p><em></p><div class="fragment"><div class="line"><span class="comment">// Make exponential system that decays from 4 to 0 with decay constant 6, and tau=1.0</span></div>
<div class="line"><span class="keywordtype">double</span> alpha = 6.0;                <span class="comment">// Decay constant</span></div>
<div class="line"><span class="keywordtype">double</span> tau = 1.0;                  <span class="comment">// Time constant </span></div>
<div class="line">VectorXd x_init(1); x_init &lt;&lt; 4.0; <span class="comment">// Initial state (a 1D vector with the value 4.0 inside using Eigen comma initializer)</span></div>
<div class="line">VectorXd x_attr(1); x_attr &lt;&lt; 0.0; <span class="comment">// Attractor state</span></div>
<div class="line">DynamicalSystem* dyn_sys = <span class="keyword">new</span> ExponentialSystem(tau, x_init, x_attr, alpha);</div>
<div class="line"></div>
<div class="line">Eigen::VectorXd x, xd;</div>
<div class="line">dyn_sys-&gt;integrateStart(x,xd); <span class="comment">// Start the integration</span></div>
<div class="line"><span class="keywordtype">double</span> dt = 0.01;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> t=0.0; t&lt;1.5; t+=dt)</div>
<div class="line">{</div>
<div class="line">  dyn_sys-&gt;integrateStep(dt,x,x,xd);          <span class="comment">// Takes current state x, integrates system, and writes next state in x, xd</span></div>
<div class="line">  cout &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; xd &lt;&lt; endl; <span class="comment">// Output current time, state and rate of change</span></div>
<div class="line">}</div>
<div class="line"><span class="keyword">delete</span> dyn_sys;</div>
</div><!-- fragment --><p></em></p>
<p><em><em>Remark</em>. Both analyticalSolution and differentialEquation functions above are const, i.e. they do not change the DynamicalSystem itself.</em></p>
<p><em><em>Remark</em>. DynamicalSystem::integrateStep uses either Euler integration, or 4-th order Runge-Kutta. The latter is more accurate, but requires 4 calls of DynamicalSystem::differentialEquation() instead of 1). Which one is used can be set with DynamicalSystem::set_integration_method(). To numerically integrate a dynamical system, one must carefully choose the integration time dt. Choosing it too low leads to inaccurate integration, and the numerical integration will diverge from the 'true' solution acquired through analytical solution. See <a href="http://en.wikipedia.org/wiki/Euler%27s_method">http://en.wikipedia.org/wiki/Euler%27s_method</a> for examples. Choosing dt depends entirely on the time-scale (seconds vs. years) and parameters of the dynamical system (time constant, decay parameters).</em></p>
<p><em></em></p>
<h2><a class="anchor" id="dynsys_implementation1_plotting"></a>
Plotting</h2>
<p><em> If you save the output of a dynamical in a file with format (where D is the dimensionality of the system, and T is the number of time steps) </p><pre class="fragment">x^0_0 x^1_0 .. x^D_0   xd^0_0 xd^1_0 .. xd^D_0   t_0   
x^0_1 x^1_1 .. x^D_1   xd^0_1 xd^1_1 .. xd^D_1   t_1   
   :     :       :         :      :       :       :    
x^0_T x^1_T .. x^D_T   xd^0_T xd^1_T .. xd^D_T   t_T   
</pre><p> you can plot this output with </p><div class="fragment"><div class="line">python dynamicalsystems/plotting/plotDynamicalSystem.py file.txt</div>
</div><!-- fragment --><p></em></p>
<p><em></em></p>
<h2><a class="anchor" id="dynsys_implementation1_demo"></a>
Demos</h2>
<p><em> A demonstration of how to initialize and integrate an ExponentialSystem is in <a class="el" href="demoExponentialSystem_8cpp.html" title="Demonstrates how to initialize and integrate an exponential dynamical system. ">demoExponentialSystem.cpp</a></em></p>
<p><em>A more complete demonstration including all implemented dynamical systems is in <a class="el" href="demoDynamicalSystems_8cpp.html" title="Demonstrates how to initialize, integrate, perturb all implemented exponential systems. ">demoDynamicalSystems.cpp</a>. If you call the resulting executable with a directory argument, e.g. </p><div class="fragment"><div class="line">./demoDynamicalSystems /tmp/demoDynamicalSystems</div>
</div><!-- fragment --><p> it will save results to file, which you can plot with for instance: </p><div class="fragment"><div class="line">python plotDynamicalSystem.py /tmp/demoDynamicalSystems/ExponentialSystem/results_rungekutta.txt</div>
<div class="line">python plotDynamicalSystem.py /tmp/demoDynamicalSystems/ExponentialSystem/results_euler.txt</div>
</div><!-- fragment --><p> Different test can be performed with the dynamical system. The test can be chosen by passing further argument, e.g. </p><div class="fragment"><div class="line">./demoDynamicalSystems /tmp/demoDynamicalSystems rungekutta euler</div>
</div><!-- fragment --><p> will integrate the dynamical systems with both the Runge-Kutta and simple Euler method. The available tests are: </p><ul>
<li>"rungekutta" - Use 4th-order Runge-Kutta integration (more accurate, but more calls of DynamicalSystem::differentialEquation) </li>
<li>"euler" - Use simple Euler integration (less accurate, but faster) </li>
<li>"analytical" - Use the analytical solution instead of numerical integration </li>
<li>"tau" - Change tau before doing numerical integration </li>
<li>"attractor" - Change the attractor state during numerical integration </li>
<li>"perturb" - Perturb the state during numerical integration</li>
</ul>
<p>To compare for instance the analytical solution with the Runge-Kutta integration in a plot, you can do </p><div class="fragment"><div class="line">python plotDynamicalSystemComparison.py /tmp/demoDynamicalSystems/ExponentialSystem/results_analytical.txt  /tmp/demoDynamicalSystems/ExponentialSystem/results_rungekutta.txt</div>
</div><!-- fragment --><p></em></p>
<p><em></em></p>
<h1><a class="anchor" id="sec_dyn_sys_properties"></a>
Properties and Features of Linear Dynamical Systems</h1>
<h2><a class="anchor" id="sec_dyn_sys_convergence"></a>
Convergence towards the Attractor</h2>
<p>In the limit of time, the dynamical system for exponential decay will converge to 0 (i.e. <img class="formulaInl" alt="$x(\infty) = x_0e^{-\alpha\infty} = 0$" src="form_59.png"/>). The value 0 is known as the <em>attractor</em> of the system. For simple dynamical systems, it is possible to <em>proove</em> that they will converge towards the attractor.</p>
<p>Suppose that the attractor state in our running example is not 0, but 1. In that case, we change the attractor state of the exponential decay to <img class="formulaInl" alt="$x^g$" src="form_60.png"/> ( <img class="formulaInl" alt="$g$" src="form_61.png"/>=goal) and define the following differential equation: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \dot{x} =&amp; -\alpha(x-x^g) &amp; \mbox{~with attractor } x^g \end{eqnarray*}" src="form_62.png"/>
</p>
<p>This system will now converge to the attractor state <img class="formulaInl" alt="$x^g$" src="form_60.png"/>, rather than 0.</p>
<div class="image">
<img src="change_tau_attr-svg.png" alt="change_tau_attr-svg.png"/>
<div class="caption">
Changing the attractor state or time constant.</div></div>
<h2><a class="anchor" id="sec_dyn_sys_perturbations"></a>
Robustness to Perturbations</h2>
<p>Another nice feature of dynamical systems is their robustness to perturbations, which means that they will converge towards the attractor even if they are perturbed. The figure below shows how the perturbed system (cyan) converges towards the attractor state just as the unperturbed system (blue) does.</p>
<div class="image">
<img src="perturb-svg.png" alt="perturb-svg.png"/>
<div class="caption">
Perturbing the dynamical system.</div></div>
<h2><a class="anchor" id="sec_dyn_sys_time_constant"></a>
Changing the speed of convergence: The time constant</h2>
<p>The rates of change computed by the differential equation can be increased or decreased (leading to a faster or slower convergence) with a <em>time</em> <em>constant</em>, which is usually written as follows:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \tau\dot{x} =&amp; -\alpha(x-x^g)\\ \dot{x} =&amp; (-\alpha(x-x^g))/\tau \end{eqnarray*}" src="form_63.png"/>
</p>
<p><em>Remark</em>. For an exponential system, decreasing the time constant <img class="formulaInl" alt="$\tau$" src="form_64.png"/> has the same effect as increasing <img class="formulaInl" alt="$\alpha$" src="form_9.png"/>. For more complex dynamical systems with several parameters, it is useful to have a separate parameter that changes only the speed of convergence, whilst leaving the other parameters the same.</p>
<h2><a class="anchor" id="sec_dyn_sys_multi"></a>
Multi-dimensional states</h2>
<p>The state <img class="formulaInl" alt="$x$" src="form_40.png"/> need not be a scalar, but may be a vector. This then represents a multi-dimensional state, i.e. <img class="formulaInl" alt="$\tau\dot{\mathbf{x}} = -\alpha(\mathbf{x}-\mathbf{x}^g)$" src="form_65.png"/>. In the code, the size of the state vector <img class="formulaInl" alt="$dim(\mathbf{x})\equiv dim(\dot{\mathbf{x}})$" src="form_66.png"/> of a dynamical system is returned by the function DynamicalSystem::dim()</p>
<h2><a class="anchor" id="sec_dyn_sys_autonomy"></a>
Autonomy</h2>
<p>Dynamical system that do not depend on time are called <em>autonomous</em>. For instance, the formula <img class="formulaInl" alt="$ \dot{x} = -\alpha x$" src="form_67.png"/> does not depend on time, which means the exponential system is autonomous.</p>
<h2><a class="anchor" id="Implementation"></a>
Implementation</h2>
<p><em> The attractor state and time constant of a dynamical system are usually passed to the constructor. They can be changed afterwards with with DynamicalSystem::set_attractor_state and DynamicalSystem::set_tau. Before integration starts, the initial state can be set with DynamicalSystem::set_initial_state. This influences the output of DynamicalSystem::integrateStart, but not DynamicalSystem::integrateStep.</em></p>
<p><em>Further (first order) linear dynamical systems that are implemented in this module is a SigmoidSystem (see <a href="http://en.wikipedia.org/wiki/Exponential_decay">http://en.wikipedia.org/wiki/Exponential_decay</a> and <a href="http://en.wikipedia.org/wiki/Sigmoid_function">http://en.wikipedia.org/wiki/Sigmoid_function</a>), as well as a dynamical system that has a constant velocity (TimeSystem), so as to mimic the passing of time (time moves at a constant rate per time ;-)</em></p>
<p><em> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \dot{x} =&amp; -\alpha (x-x^g) &amp; \mbox{exponential decay/growth} \label{equ_}\\ \dot{x} =&amp; \alpha x (\beta-x) &amp; \mbox{sigmoid} \label{equ_}\\ \dot{x} =&amp; 1/\tau &amp; \mbox{constant velocity (mimics the passage of time)} \label{equ_}\\ \end{eqnarray*}" src="form_68.png"/>
</p>
<p></em></p>
<p><em></p><div class="image">
<img src="sigmoid-svg.png" alt="sigmoid-svg.png"/>
<div class="caption">
Exponential (blue) and sigmoid (purple) dynamical systems.</div></div>
</em></p>
<p><em></em></p>
<h1><a class="anchor" id="dyn_sys_second_order_systems"></a>
Second-Order Systems</h1>
<p>The <b>order</b> of a dynamical system is the order of the highest derivative in the differential equation. For instance, <img class="formulaInl" alt="$\dot{x} = -\alpha x$" src="form_53.png"/> is of order 1, because the derivative with the highest order ( <img class="formulaInl" alt="$\dot{x}$" src="form_43.png"/>) has order 1. Such a system is known as a first-order system. All systems considered so far have been first-order systems, because the derivative with the highest order, i.e. <img class="formulaInl" alt="$ \dot{x} $" src="form_69.png"/>, has always been of order 1.</p>
<h2><a class="anchor" id="dyn_sys_spring_damper"></a>
Spring-Damper Systems</h2>
<p>An example of a second order system (which also has terms <img class="formulaInl" alt="$ \ddot{x} $" src="form_70.png"/>) is a spring-damper system (see <a href="http://en.wikipedia.org/wiki/Damped_spring-mass_system">http://en.wikipedia.org/wiki/Damped_spring-mass_system</a>), where <img class="formulaInl" alt="$k$" src="form_71.png"/> is the spring constant, <img class="formulaInl" alt="$c$" src="form_72.png"/> is the damping coefficient, and <img class="formulaInl" alt="$m$" src="form_73.png"/> is the mass:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} m\ddot{x}=&amp; -kx -c\dot{x} &amp; \mbox{spring-damper (2nd order system)} \label{equ_}\\ \ddot{x}=&amp; (-kx -c\dot{x})/m &amp; \end{eqnarray*}" src="form_74.png"/>
</p>
<h2><a class="anchor" id="dyn_sys_critical_damping"></a>
Critical Damping</h2>
<p>A spring-damper system is called critically damped when it converges to the attractor as quickly as possible without overshooting, as the red plot in <a href="http://en.wikipedia.org/wiki/File:Damping_1.svg">http://en.wikipedia.org/wiki/File:Damping_1.svg</a>. This happens when <img class="formulaInl" alt="$c = 2\sqrt{mk}$" src="form_5.png"/>.</p>
<h2><a class="anchor" id="dyn_sys_rewrite_second_first"></a>
Rewriting one 2nd Order Systems as two 1st Order Systems</h2>
<p>For implementation purposes, it is more convenient to work only with 1st order systems. Fortunately, we can expand the state <img class="formulaInl" alt="$ x $" src="form_75.png"/> into two components <img class="formulaInl" alt="$ x = [y~z]^T$" src="form_76.png"/> with <img class="formulaInl" alt="$ z = \dot{y}$" src="form_77.png"/>, and rewrite the differential equation as follows:</p>
<p><img class="formulaInl" alt="$ \left[ \begin{array}{l} \dot{y} \\ \dot{z} \end{array} \right] = \left[ \begin{array}{l} z \\ (-ky -cz)/m \end{array} \right] $" src="form_78.png"/></p>
<p>With this rewrite, the left term contains only first order derivatives, and the right term does not contain any derivatives. This is thus a first order system. Integrating such an expanded system is done just as one would integrate a dynamical system with a multi-dimensional state:</p>
<h2><a class="anchor" id="Implementation"></a>
Implementation</h2>
<p><em> The constructor DynamicalSystem::DynamicalSystem immediately converts second order systems into first order systems with an expanded state.</em></p>
<p><em>The function DynamicalSystem::dim() returns the size of the entire state vector <img class="formulaInl" alt="$ x = [y~z]$" src="form_79.png"/>, the function DynamicalSystem::dim_orig() return the size of only the <img class="formulaInl" alt="$ y $" src="form_80.png"/> component. The attractor and initial state must always have the size returned by DynamicalSystem::dim_orig(). </em> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 9 2016 10:16:52 for DMP_BBO library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
